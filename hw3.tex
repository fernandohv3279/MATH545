\documentclass{article}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\title{MATH 545: Homework 1}
\author{Yingli, Laurette, Fernando}
\date{October 9, 2023}
\begin{document}
\maketitle
\section{Section 2.4}
\subsection{Exercise 1}
Solve the diffusion equation with initial condition
\[
\phi(x)=1\text{ for }|x|<l \quad \text{and} \quad \phi(x)=0 \text{
for } |x|>l.
\]
Write your answer in terms of $\mathscr{E}$rf($x$).

\textbf{Solution:}

We saw in class that the solution to this problem is:
\[
    u(t,x)=S(t,\cdot)\ast u_0(x),
\]
Where $S$ is the heat kernel. So:
\begin{align*}
    u(t,x)
    &=S(t,\cdot)\ast u_0(x)\\
    &=\int S(t,x-y)u_0(y)dy\\
    &=\int_{|x|<l} S(t,x-y)u_0(y)dy+ \int_{|x|> l} S(t,x-y)u_0(y)dy\\
    &=\int_{|x|<l} S(t,x-y)dy\\
    &=\int_{-l}^lS(t,x-y)dy\\
    &=\int_{-l}^l\frac{1}{\sqrt{4\pi t D}} e^{-(x-y)^2/(4tD)}dy
\end{align*}
Now let $p=\frac{y-x}{\sqrt{4tD}}$, then $dp=\frac{dy}{\sqrt{4tD}}\iff
\sqrt{4tD}dp=dy$. So:
\begin{align*}
    u(t,x)
    &=\frac{\sqrt{4tD}}{\sqrt{4\pi t
    D}}\int_{\frac{-l-x}{\sqrt{4tD}}}^{\frac{l-x}{\sqrt{4tD}}} e^{-p^2}dp\\
    &=\frac{1}{\sqrt{\pi}}\int_{\frac{-l-x}{\sqrt{4tD}}}^{\frac{l-x}{\sqrt{4tD}}} e^{-p^2}dp\\
    &=\frac{1}{\sqrt{\pi}}\left(\int_{\frac{-l-x}{\sqrt{4tD}}}^{0}
    e^{-p^2}dp+\int_{0}^{\frac{l-x}{\sqrt{4tD}}} e^{-p^2}dp\right)\\
    &=\frac{1}{\sqrt{\pi}}\left(-\int_{0}^{\frac{-l-x}{\sqrt{4tD}}}
    e^{-p^2}dp+\int_{0}^{\frac{l-x}{\sqrt{4tD}}} e^{-p^2}dp\right)\\
    &=\frac{1}{2}\left(-\mathscr{E}\text{rf}\left(\frac{-l-x}{\sqrt{4tD}}\right)+\mathscr{E}\text{rf}\left(\frac{l-x}{\sqrt{4tD}}\right)\right).
\end{align*}
\subsection{Exercise 15}
Prove the uniqueness of the diffusion problem with Neumann boundary conditions:
\[
    u_t-ku_{xx}=f(x,t) \quad \text{for } 0<x<l,t>0 \quad u(x,0)=\phi(x)
\]
\[
    u_x(0,t)=g(t)\quad u_x(l,t)=h(t)
\]
by the energy method.

\textbf{Solution:}

Suppose there are two solutions: $u_1$ and $u_2$, now consider their
difference: $w=u_1-u_2$; it satisfies:
\[
    w_t -kw_{xx}=0 \quad \text{for } 0<x<l,t>0 \quad w(x,0)=0
\]
\[
w_x(0,t)=0\quad w_x(l,t)=0
\]
then:
\[
0=w_t-kw_{xx}=w(w_t-kw_{xx})=(w^2/2)_t+(-kww_x)_x+kw_x^2.
\]
Now we integrate with respect to $x$ from 0 to $l$ to get:
\[
0=\int_0^l\left(\frac{1}{2}w^2\right)_tdx-kww_x\Big|_{x=0}^{x=l}+k\int_0^lw_x^2dx.
\]
Because of the Neumann boundary condition we have $w_x(0,t)=w_x(l,t)=0$. So:
\[
\int_0^l\left(\frac{1}{2}w^2\right)_tdx=-k\int_0^lw_x^2dx\leq 0.
\]
Under the appropriate conditions (which we will assume to have) we can write:
\[
\int_0^l\left(\frac{1}{2}w^2\right)_tdx=\frac{d}{dt}\int_0^l\frac{1}{2}w^2dx
\]
Then:
\[
\frac{d}{dt}\int_0^l\frac{1}{2}w^2dx=-k\int_0^lw_x^2dx\leq 0.
\]
Which means that $\int_0^lw^2dx$ is decreasing with respect to $t$, so
\[
\int_0^l(w(x,t))^2dx\leq\int_0^l(w(x,0))^2dx
\]
The right hand side of the previous inequality is 0 because $w(x,0)=0$, it then
follows that $w(x,t)\equiv 0$, hence $u_1\equiv u_2$.
\subsection{Exercise 16}
Solve the diffusion equation with constant dissipation:
\[
    u_t-ku_{xx}+bu=0\quad \text{for }-\infty<x<\infty \quad \text{with } u(x,0)=\phi(x),
\]
where $b>0$ is a constant.

\textbf{Solution:}

As suggested by the hint we do the change of variables $u(x,t)=e^{-bt}v(x,t)$,
notice that with this change of variables the initial condition remains the
same, after the change we obtain:
\begin{align*}
-be^{-bt}v(x,t)+e^{-bt}v_t(x,t)-ke^{-bt}v_{xx}(x,t)+be^{-bt}v(x,t)=0\\
v_t(x,t)-kv_{xx}(x,t)=0\\
\end{align*}
Then our solution (using the notation we saw in class) is:
\[
v(x,t)=S(t,\cdot)\ast \phi(x)
\]
Finally we multiply by $e^{-bt}$ to recover $u$:
\[
    u(x,t)=e^{-bt}S(t,\cdot)\ast \phi(x).
\]
\subsection{Exercise 18}
Solve the heat equation with convection:
\[
u_t-ku_{xx}+Vu_x=0\quad \text{for }-\infty<x<\infty \quad \text{with } u(x,0)=\phi(x),
\]
where V is a constant.

\textbf{Solution:}

We proceed according to the hint and make the change $y=x-Vt$, let
$w(y,t)=u(y+Vt,t)=u(x,t)$, then $w_y=u_x$, $w_{yy}=u_{xx}$ and $w_t=Vu_x+u_t$.
Notice that the initial condition remains the same.
Substituting in the original equation we get
\begin{align*}
w_t-Vw_y -kw_{yy}+Vw_y=0\\
w_t-kw_{yy}=0.
\end{align*}
The solution to this is
\[
    w(y,t)=S(t,\cdot)\ast \phi(y),
\]
so
\[
    u(x,t)=S(t,\cdot)\ast \phi(x-Vt).
\]
\section{Section 4.1}
\subsection{Exercise 3}
A quantum-mechanical particle on the line with an infinite potential outside
the interval $(0,l)$ ("particle in a box") is given by Schr\"odinger's equation
$u_t=iu_{xx}$ on $(0,l)$ with Dirichlet conditions at the ends. Separate the
variables and use (8) to find its representation as a series.

\textbf{Solution:}

\fbox{
\parbox{0.91\textwidth}{
\textbf{Note:} The problem says that we should use (8), so in order to do that let's
assume that we have homogeneous Dirichlet boundary conditions.
}
}

We separate variables to get:
\[
    XT_t=iX_{xx}T,
\]
then:
\[
    \frac{T_t}{iT}=\frac{X_{xx}}{X},
\]
which implies that
\[
    \frac{T_t}{iT}=\frac{X_{xx}}{X}=-\lambda,
\]
for $\lambda$ constant.

For the second equation we can use (8) and get
\[
    \lambda_n=\left(\frac{n\pi}{l}\right)^2,\quad X_n(x)=\sin\left(\frac{n\pi
    x}{l}\right) \quad (n=1,2,3,\dots).
\]
As for the equation
\[
    T_n'=-i\lambda_n T_n,
\]
this one has solution
\[
    C_ne^{-i\lambda_nt}.
\]
So the final solution is:
\[
    u(x,t)=\sum_{n=1}^\infty C_n\sin\left(\frac{n\pi
    x}{l}\right)e^{-i\left(\frac{n\pi}{l}\right)^2t}.
\]
\section{Section 4.2}
\subsection{Exercise 2}
Consider the equation $u_{tt}=c^2u_{xx}$ for $0<x<l$, with the boundary
conditions $u_x(0,t)=0$, $u(l,t)=0$ (Neumann at the left, Dirichlet at the right.)
\subsubsection{Part a}
Show that the eigenfunctions are $\cos\left[\left(n+\frac{1}{2}\right)\pi x/l\right]$.

\textbf{Solution:}

We begin by writing $u(x,t)=X(x)T(t)$, then
\begin{align*}
XT_{tt}=c^2X_{xx}T\\
\frac{T_{tt}}{c^2T}=\frac{X_{xx}}{X}
\end{align*}
which implies that:
\begin{align*}
\frac{c^2T_{tt}}{T}=\frac{X_{xx}}{X}=-\lambda
\end{align*}
for $\lambda$ constant.

Now we analyse the sign of $\lambda$ like we did in
class. First note that
\[
(X,X_{xx})=\int_0^l\overline{X}X_{xx}dx
=[\overline{X}X_x]\Big|_0^l-\int_0^l|X_x|^2dx
=-\int_0^l|X_x|^2dx\leq 0,
\]
where we used the fact that $\overline{X}(l)X_x(l)=0$ by the Dirichlet
condition and  $\overline{X}(0)X(0)=0$ by the Neumann condition.

Using the linearity of the inner product we conclude that
\[
    (X,X_{xx})=-\lambda(X,X)=-\lambda||X||^2\leq 0,
\]
i.e. $\lambda \geq 0$.

Now we check if $\lambda=0$ is actually possible; in this case we have
\[
    X_{xx}=0,
\]
then
\[
    X(x)=ax+b;
\]
but the Neumann condition on $x=0$ implies that $a=0$, so $X(x)=b$, but the
Dirichlet boundary condition on $x=l$ implies that $b=0$.

\fbox{
\parbox{0.91\textwidth}{
\textbf{Conclusion:} $\lambda=0$ gives us the 0 eigenfunction so we are not
interested in this case, therefore we can assume $\lambda > 0$.
}
}

Now we write $\lambda=\mu^2$; the problem then becomes:
\[
    X_{xx}+\mu^2X=0
\]
which has the solution:
\[
X(x) = A\cos(\mu x)+B\sin(\mu x),
\]
then derivative of $X$ is
\[
X_x(x) = -A\mu\sin(\mu x)+B\mu\cos(\mu x),
\]
Now we use the Neumann condition to get
\[
    X_x(x)=B\mu=0.
\]
so $B=0$. From the Dirichlet condition we obtain
\[
X(l)=A\cos(\mu l)=0,
\]
so $\mu_n = (n+1/2)\pi/l$, then the eigenfunctions are indeed
\[
\cos\left[\left(n+1/2\right)\pi x/l\right],
\]
where $n\in \mathbb{N}$.
\subsubsection{Part b}
Write the series expansion for a solution $u(x,t)$.

\textbf{Solution:}

Now we find the solution to
\[
    T_n''=-\lambda_nc^2T_n,
\]
which we know is
\[
T_n(t)=C_n\cos(c\mu_n t) + D_n\sin(c\mu_n t)
\]
so the solution is:
\[
u(t,x)=\sum_{n=0}^\infty \left(\widetilde{C_n}\cos(c\mu_n t) +
    \widetilde{D_n}\sin(c\mu_n t)\right)\cos\left[\left(n+1/2\right)\pi
x/l\right].
\]
\section{Section 4.3}
\subsection{Exercise 2}
Consider the eigenvalue problem with Robin BCs at both ends:
\[
    -X''=\lambda X
\]
\[
    X'(0)-a_0X(0)=0, \quad X'(l)+a_lX(l)=0.
\]
\subsubsection{part a}
Show that $\lambda = 0$ is an eigenvalue if and only if $a_0+a_l=-a_0a_ll$.

\textbf{Solution:}

If $\lambda=0$ then $X(x)=mx+b$ and $X'(x)=m$. Using the initial condition
yields
\[
    m-a_0b=0, \quad m+a_l(ml+b)=0.
\]
Substituting $m=a_0b$ we obtain
\[
    b(a_0+a_la_0l+a_l)=0.
\]
If $b=0$ then $m=0$ and we have the 0 eigenfunction so this is not a solution,
therefore the only option left is that:
\[
    a_0+a_l=-a_0a_ll.
\]
\subsubsection{part b}
\end{document}
